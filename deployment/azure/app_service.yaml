# Azure App Service Configuration

# App Service details
site_name: ai-rag-agent
runtime: python|3.11
startup_command: uvicorn app.main:app --host 0.0.0.0 --port 8000

# App Settings (Environment Variables)
app_settings:
  - name: ENVIRONMENT
    value: production
  - name: LOG_LEVEL
    value: INFO
  - name: OPENAI_API_KEY
    value: <secret>  # Set via Azure Portal or CLI
  - name: OPENAI_MODEL
    value: gpt-4-turbo-preview
  - name: OPENAI_EMBEDDING_MODEL
    value: text-embedding-3-small
  - name: VECTOR_STORE_TYPE
    value: faiss
  - name: VECTOR_STORE_PATH
    value: ./data/vector_store
  - name: SESSION_TTL
    value: 3600
  - name: MAX_CONVERSATION_HISTORY
    value: 10
  - name: CHUNK_SIZE
    value: 1000
  - name: CHUNK_OVERLAP
    value: 200
  - name: TOP_K_RESULTS
    value: 3
  - name: CORS_ORIGINS
    value: "*"

# Scale settings
scale:
  min_instances: 1
  max_instances: 3
  scale_out_instances: 1
  rule:
    metric: CpuPercentage
    threshold: 70

# Logging
logging:
  application_logs: filesystem
  detailed_error_messages: true
  failed_request_tracing: true
  http_logs: filesystem
